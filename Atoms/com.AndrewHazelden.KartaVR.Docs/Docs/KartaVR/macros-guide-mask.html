<!DOCTYPE html>
<html>
<head>
<title>Documentation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
/* Stylesheet for Markdown */

/* RESET
=============================================================================*/

html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
}

/* BODY
=============================================================================*/

@font-face {
    font-family: 'Source Sans Pro';
    font-style: normal;
    font-weight: 300;
    src: url('fonts/SourceSansPro-Regular.ttf');
}

@font-face {
    font-family: 'Source Code Pro';
    font-style: normal;
    font-weight: 400;
    src: url('fonts/SourceCodePro-Regular.ttf');
}

@import url("fonts/font-awesome.min.css");

body {
  font-family: "Source Sans Pro", Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  color: #333;
  background-color: #1C1C1C;
  padding: 20px;
  max-width: 960px;
  margin: 0 auto;
}

body>*:first-child {
  margin-top: 0 !important;
}

body>*:last-child {
  margin-bottom: 0 !important;
}

/* BLOCKS
=============================================================================*/

p, blockquote, ul, ol, dl, table, pre {
  margin: 15px 0;
  color: #AAAAAA;
  /* color: #7D8686; */
}

/* HEADERS
=============================================================================*/

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
}

h1 tt, h1 code, h2 tt, h2 code, h3 tt, h3 code, h4 tt, h4 code, h5 tt, h5 code, h6 tt, h6 code {
  font-size: inherit;
}

h1 {
  font-size: 28px;
  font-weight: 600;
  color: #FFFFFF;
}

h2 {
  font-size: 24px;
  font-weight: 500;
  border-bottom: 2px solid #D0D0D0;
  color: #D0D0D0;
}

h3 {
  font-size: 18px;
  font-weight: 400;
  color: #D0D0D0;
}

h4 {
  font-size: 16px;
  color: #D0D0D0;
}

h5 {
  font-size: 14px;
  color: #D0D0D0;
}

h6 {
  font-size: 14px;
  color: #D0D0D0;
}

h7 {
  font-size: 14px;
  color: #D0D0D0;
  /* color: #277BA5; */
}

body>h2:first-child, body>h1:first-child, body>h1:first-child+h2, body>h3:first-child, body>h4:first-child, body>h5:first-child, body>h6:first-child {
  margin-top: 0;
  padding-top: 0;
}

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0;
}

h1+p, h2+p, h3+p, h4+p, h5+p, h6+p {
  margin-top: 10px;
}

/* LINKS
=============================================================================*/

a {
  color: #4183C4;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

/* LISTS
=============================================================================*/

ul, ol {
  padding-left: 30px;
  color: #C4C4C4;
}

ul li > :first-child, 
ol li > :first-child, 
ul li ul:first-of-type, 
ol li ol:first-of-type, 
ul li ol:first-of-type, 
ol li ul:first-of-type {
  margin-top: 0px;
}

ul ul, ul ol, ol ol, ol ul {
  margin-bottom: 0;
}

dl {
  padding: 0;
}

dl dt {
  font-size: 14px;
  font-weight: bold;
  font-style: italic;
  padding: 0;
  margin: 15px 0 5px;
}

dl dt:first-child {
  padding: 0;
}

dl dt>:first-child {
  margin-top: 0px;
}

dl dt>:last-child {
  margin-bottom: 0px;
}

dl dd {
  margin: 0 0 15px;
  padding: 0 15px;
}

dl dd>:first-child {
  margin-top: 0px;
}

dl dd>:last-child {
  margin-bottom: 0px;
}

/* CODE
=============================================================================*/

pre, code, tt {
  font-size: 12px;
  font-family: "Source Code Pro", monospace;
}

code, tt {
  margin: 0 0px;
  padding: 0px 0px;
  white-space: nowrap;
  border: 1px solid #262626;
  background-color: #363636;
  color: #D0D0D0;
  border-radius: 3px;
}

pre>code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent;
}

pre {
  background-color: #363636;
  border: 1px solid #262626;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
}

pre code, pre tt {
  background-color: transparent;
  border: none;
}

kbd {
    -moz-border-bottom-colors: none;
    -moz-border-left-colors: none;
    -moz-border-right-colors: none;
    -moz-border-top-colors: none;
    background-color: #DDDDDD;
    background-image: linear-gradient(#F1F1F1, #DDDDDD);
    background-repeat: repeat-x;
    border-color: #DDDDDD #CCCCCC #CCCCCC #DDDDDD;
    border-image: none;
    border-radius: 2px 2px 2px 2px;
    border-style: solid;
    border-width: 1px;
    font-family: "Source Sans Pro", Helvetica, arial, sans-serif;
    line-height: 10px;
    padding: 1px 4px;
}

/* QUOTES
=============================================================================*/

blockquote {
  border-left: 4px solid #DDD;
  padding: 0 15px;
  color: #777;
}

blockquote>:first-child {
  margin-top: 0px;
}

blockquote>:last-child {
  margin-bottom: 0px;
}

/* HORIZONTAL RULES
=============================================================================*/

hr {
  clear: both;
  margin: 15px 0;
  height: 0px;
  overflow: hidden;
  border: none;
  background: transparent;
  border-bottom: 4px solid #ddd;
  padding: 0;
}

/* TABLES
=============================================================================*/

table th {
  font-weight: bold;
}

table th, table td {
  /* border: 1px solid #ccc; */ 
  /* padding: 6px 13px; */ 
}

table tr {
  /* border-top: 1px solid #ccc; */
  /* background-color: #363636; */
  /* color: #D0D0D0; */
}


/* IMAGES
=============================================================================*/

img {
  max-width: 80%;
  /* max-width: 100%; */
  display: block;
  margin-left: auto;
  margin-right: auto;
}
</style>
</head>
<body><h1>Mask Macros</h1>
<table>
<tr>
  <td><ul>
    <li><a href="macros-guide-mask.html#AlphaMaskErode">AlphaMaskErode</a></li>
    <li><a href="macros-guide-mask.html#AlphaMaskMerge">AlphaMaskMerge</a></li>
    <li><a href="macros-guide-mask.html#FisheyeCropMask">FisheyeCropMask</a></li>
    <li><a href="macros-guide-mask.html#FisheyeMask">FisheyeMask</a></li>
    <li><a href="macros-guide-mask.html#PTGuiMatteControl">PTGuiMatteControl</a></li>
  </ul></td>
  <td><ul>
    <li><a href="macros-guide-mask.html#SplitViewMaskInline">SplitViewMaskInline</a></li>
    <li><a href="macros-guide-mask.html#SplitViewMaskRectangle">SplitViewMaskRectangle</a></li>
  </ul></td>
</tr>
</table>
<h2><a name="AlphaMaskErode"></a>AlphaMaskErode</h2>
<p><img src="images/macro-alpha-mask-erode-gui.png" alt="AlphaMaskErode GUI" /></p>
<p>The AlphaMaskErode macro helps dilate/erode, and blur the edge of an alpha mask. This is useful for smoothly blending together multi-camera panoramic 360Â° footage that was stitched in PTgui with the &quot;individual layers&quot; or &quot;individual HDR layers&quot; export options.</p>
<p>This node is great for contracting the border of an alpha channel when doing masking on tripod removal tasks, or to help smooth the junction of UV pass converted panoramic imagery when you have overlapping hard edges on the image layers you want to composite together.</p>
<p><img src="images/macro-alpha-mask-erode.png" alt="AlphaMaskErode Macro" /></p>
<p>The &quot;Erode Filter&quot; control is used to specify if you want to shrink the alpha channel using a hard &quot;box&quot; style erode/dilate setting, or you could use a soft and smooth &quot;Gaussian&quot; type of erode/dilate effect.</p>
<p>The &quot;Erode Lock X/Y&quot; control is used to choose if you want to control the alpha channel contracting &quot;Erode Amount&quot;  with one linked control, or with two separate horizontal (Erode X Amount) and vertical (Erode Y Amount) controls.</p>
<p>The &quot;Erode Amount&quot; control is used to expand/shrink the alpha channel mask border using an erode/dilate type of image filtering effect. You can contract the alpha channel inwards in different geometric ways depending on your choice of &quot;Erode Filter&quot; setting.  The Box filter gives a hard edge contraction, and Gaussian filter will be very soft and diffused.</p>
<p>The &quot;Blue Filter&quot; control is used to specify what type of smoothing effect is used when the blur is generated. Generally speaking &quot;Gaussian&quot; is a good choice for almost all use cases.</p>
<p>The &quot;Blur Lock X/Y&quot; control is used to choose if you want to control the alpha channel frame blurring &quot;Blur Size&quot;  with one linked control, or with two separate horizontal (Blur X Size) and vertical (Blur Y Size) controls.</p>
<p>The &quot;Blur Size&quot; control is used to soften and blur out the alpha channel mask after the erode control has been used to erode/dilate the mask border.</p>
<p><strong>Note:</strong> The Blur controls should only be used if you are truly contracting the frame border smaller using the dilate erode options. If you are not watching what you are doing and have set the erode mode to dilate and expand the mask outwards, the blurred/feathered edge can add a slight clipped hard edge &quot;cookie cutter&quot; effect at the matte border!</p>
<p>The &quot;Blur Blend&quot; control is used to choose if you want to mix in a percentage of the original image with the blurred image result. A value of 1.0 will show only the blurred output, a value of 0.5 will show 50% of the blurred result mixed with 50% of the original unblurred image, and a value of 0.0 will show only the original unblurred image.</p>
<p>The output from the AlphaMaskErode node is called &quot;output&quot;. Typically you would connect an RGBA image with an alpha channel into the AlphaMaskErode node and effect it directly.</p>
<p>You can also use the AlphaMaskErode node on an image that only has an alpha channel or a vector BSpline mask and then send the contracted / expanded shape result on to another node using the typical &quot;Effect Mask&quot; connection approach.</p>
<p><img src="images/macro-alpha-mask-node.png" alt="AlphaMaskErode Node" /></p>
<h2><a name="AlphaMaskMerge"></a>AlphaMaskMerge</h2>
<p><img src="images/macro-alpha-mask-merge-gui.png" alt="AlphaMaskMerge GUI" /></p>
<p>The AlphaMaskMerge node allows you to merge an external alpha mask image / B-Spline mask with the current image data. Then an Alpha Multiply operation will clean up transparent areas in the image and fill them with black in the RGB channels by pre-multiplying the alpha channel data.</p>
<p>This macro cuts down on the node sprawl when creating a Fusion based UV Pass panoramic stitching project file.</p>
<p><img src="images/macro-alpha-mask-merge.png" alt="AlphaMaskMerge Macro" /></p>
<p><strong>Noe:</strong> If you set the AlphaMaskMerge node to &quot;bypass&quot; mode then the external alpha channel matte input will be skipped and the original RGB image will pass through the node unaffected.</p>
<p>The AlphaMaskMerge node has two inputs called &quot;Image&quot; and &quot;EffectMask&quot;. The output from the AlphaMaskMerge node is called &quot;output&quot;.</p>
<p>To use the AlphaMaskMerge node you would connect an RGB image to the &quot;image&quot; channel and a B-Spline mask to the &quot;EffectMask&quot; channel.</p>
<p><img src="images/macro-alpha-mask-merge-node.png" alt="AlphaMaskMerge Node" /></p>
<h2><a name="FisheyeCropMask"></a>FisheyeCropMask</h2>
<p><img src="images/macro-fisheye-crop-mask.png" alt="FisheyeCropMask" /></p>
<p>The FisheyeCropMask macro generates a circular alpha channel mask element with a customized control for clipping off and feathering out the square border edges on an angular fisheye image that was filmed using a typically cropped (non full-frame edge preserving) 16:9 aspect ratio video sensor.</p>
<p>This node was added primarily for its use in helping create quick and painless blending masks for use in 360Â° image stitching workflows in the KartaVR <a href="scripts.html#ptgui-project-importer">PTGui Project Importer</a> script.</p>
<p><img src="images/macro-fisheye-crop-mask-gui.png" alt="FisheyeCropMask GUI" /></p>
<p>When the Crop Soft Edge and Crop Border Width controls are used to bring in the rectangular edges of the FisheyeCropMask node you will get a fisheye mask that looks like this:</p>
<p>The when the scaling controls are used in the Fusion Viewer window they will adjust the ScaleX/Scale Y settings. The 2D move manipulator in the viewer window will adjust the Center X and Center Y settings on the node.</p>
<p>Matte Blur is used to smooth out the edges of the alpha channel and can turn harsh corners where the rectangle border edge trims off the circular mask into super smooth rounded corners.</p>
<h2><a name="FisheyeMask"></a>FisheyeMask</h2>
<p><img src="images/macro-fisheye-mask-gui.png" alt="FisheyeMask GUI" /></p>
<p>The FisheyeMask macro generates a circular alpha channel mask element that is useful for cutting out the border around a domemaster or angular fisheye image and making that area transparent.</p>
<p><img src="images/macro-fisheye-mask.png" alt="FisheyeMask Macro" /></p>
<p>The &quot;Height&quot; control is used to specify the vertical resolution of the FisheyeMask node output. The final width for the mask will be the Height value due to the fact angular fisheye images have a natural 1:1 aspect ratio.</p>
<p>The output from the FisheyeMask node is called &quot;Mask&quot;. The FisheyeMask node's output is typically connected to an image node's &quot;Effect Mask&quot; input.</p>
<p><img src="images/macro-fisheye-mask-node.png" alt="FisheyeMask Node" /></p>
<h2><a name="PTGuiMatteControl"></a>PTGuiMatteControl</h2>
<p>The PTGuiMatteControl macro is used to process imagery that has a mix of red and green color channel data that was generated by the <a href="scripts.html#ptgui-mask-importer">PTGui Mask Importer</a> script. The PTGui mask imagery is connected to the PTGuiMatteControl node's &quot;image&quot; input. The PTGuiMatteControl node will isolate the green/red color include and exclude masking information that was sourced from a PTGui project and split it into two separate alpha mask output appropriately named &quot;Exclude&quot; and &quot;Include&quot;.</p>
<p><img src="images/script-ptgui-mask-importer.png" alt="PTGui Mask Example" /></p>
<p>A BSpline curve is typically connected to the Garbage Mask input on the PTGuiMatteControl node. There is a modified version of the MatteControl UI present in this node which is used when refining the mask edges and applying the garbage mask. This UI gives you the possibility of outputting a pre-multiplied alpha channel. The Garbage Mask feature in the  PTGuiMatteControl node will equally cut away at both the include and exclude masking alpha channel outputs so it works like a big cookie cutter.</p>
<p>The &quot;Matte Blur&quot; control is very handy for giving a nice smooth edge feathering to the masking data if you want to soften a hard edge.</p>
<p><img src="images/macro-ptgui-matte-control-gui.png" alt="PTGuiMatteControl" /></p>
<h2><a name="SplitViewMaskInline"></a>SplitViewMaskInline</h2>
<p><img src="images/macro-split-view-mask-inline.png" alt="SplitViewMaskInline" /></p>
<p>The SplitViewMaskInline macro is used to mask the left/right or top/bottom view layouts when stitching circular &quot;ring&quot; shaped multi-camera stereo 360Â° camera rigs. This node is special as it works downstream in the Fusion comp and can be placed after the loader node.</p>
<p><img src="images/macro-split-view-mask-inline-gui.png" alt="SplitViewMaskInline GUI" /></p>
<p>The <strong>Split View</strong> options menu has entries for &quot;Left&quot;, &quot;Right&quot;, &quot;Top&quot;, &quot;Bottom&quot;, and &quot;Full Frame&quot; masking:</p>
<p><img src="images/macro-split-view-mask-menu.png" alt="SplitViewMaskInline GUI" /></p>
<p>The <strong>Invert</strong> control can flip the include/excluded areas of the mask image.</p>
<p>The <strong>Invert</strong> control can flip the include/excluded areas of the mask image.</p>
<p>The <strong>Soft Edge</strong> control makes it easy to apply a smooth feathering effect to the mask which makes blending the camera view images easier when the camera rig footage is connected to a Merge node.</p>
<p>The <strong>Corner Radius</strong> control turns a square shaped mask into a rounded rectangle by applying a circular radius to the edges of the shape.</p>
<p>A Loader node output is connected to the SplitViewMaskInline.Background input connection.</p>
<p><img src="images/macro-split-view-mask-inline-node.png" alt="SplitViewMaskInline Node" /></p>
<h2><a name="SplitViewMaskRectangle"></a>SplitViewMaskRectangle</h2>
<p><img src="images/macro-split-view-mask-rectangle.png" alt="SplitViewMaskRectangle" /></p>
<p>The SplitViewMaskRectangle macro is used to mask the left/right or top/bottom view layouts when stitching circular &quot;ring&quot; shaped multi-camera stereo 360Â° camera rigs. This node is typically connected to the EffectsMask input on a Loader node.</p>
<p>The SplitViewMaskRectangle node has a mask input that can be used to connect b-spline rotoshapes to further control what part of the image is masked and &quot;clipped out&quot;.</p>
<p><img src="images/macro-split-view-mask-rectangle-gui.png" alt="SplitViewMaskRectangle GUI" /></p>
<p>The <strong>Split View</strong> options menu has entries for &quot;Left&quot;, &quot;Right&quot;, &quot;Top&quot;, &quot;Bottom&quot;, and &quot;Full Frame&quot; masking:</p>
<p><img src="images/macro-split-view-mask-menu.png" alt="SplitViewMask GUI" /></p>
<p>The <strong>Invert</strong> control can flip the include/excluded areas of the mask image.</p>
<p>The <strong>Soft Edge</strong> control makes it easy to apply a smooth feathering effect to the mask which makes blending the camera view images easier when the camera rig footage is connected to a Merge node.</p>
<p>The <strong>Corner Radius</strong> control turns a square shaped mask into a rounded rectangle by applying a circular radius to the edges of the shape.</p>
<p>The SplitViewMaskRectangle node output connection is typically connected to a Loader.EffectsMask input when the original unstitched panoramic camera rig media files are loaded into Fusion.</p>
<p><img src="images/macro-split-view-mask-rectangle-node.png" alt="SplitViewMaskRectangle Node" /></p>
</body>
</html>